<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Herramienta de Encuestas Electoral</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Inter', sans-serif; background: linear-gradient(135deg, #1a3a3a 0%, #0f2a2a 100%); color: #e0e0e0; }
        header { background: linear-gradient(135deg, #2d5f5f 0%, #1a3a3a 100%); padding: 30px; text-align: center; color: white; border-bottom: 3px solid #4db8a8; }
        .container { max-width: 1200px; margin: 30px auto; padding: 0 20px; }
        .back-btn { display: inline-block; margin-bottom: 20px; padding: 10px 20px; background: #2d5f5f; color: white; text-decoration: none; border-radius: 6px; }
        .back-btn:hover { background: #3a7a7a; }
        .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(350px, 1fr)); gap: 20px; margin-bottom: 30px; }
        .card { background: #1a3a3a; border: 2px solid #2d5f5f; border-radius: 12px; padding: 25px; }
        .card h2 { color: #4db8a8; margin-bottom: 20px; }
        .question-box { background: #0f2a2a; padding: 15px; border-radius: 8px; margin-bottom: 15px; border-left: 4px solid #4db8a8; }
        input[type="number"], input[type="text"], select, textarea { width: 100%; padding: 10px; background: #0f2a2a; border: 1px solid #2d5f5f; color: #e0e0e0; border-radius: 6px; margin-bottom: 10px; }
        button { padding: 12px; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; background: #4db8a8; color: #000; transition: all 0.3s; width: 100%; }
        button:hover { background: #3da89a; transform: translateY(-2px); }
        .stats { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin: 20px 0; }
        .stat { background: #0f2a2a; padding: 15px; border-radius: 8px; text-align: center; border-left: 3px solid #4db8a8; }
        .stat-value { font-size: 1.8em; font-weight: bold; color: #4db8a8; margin: 10px 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { padding: 12px; text-align: left; border-bottom: 1px solid #2d5f5f; }
        th { background: #2d5f5f; color: #4db8a8; font-weight: bold; }
        .chart-container { position: relative; height: 300px; margin: 20px 0; }
    </style>
</head>
<body>
    <header>
        <h1>ðŸ“‹ Herramienta de Encuestas y Metodologia</h1>
        <p>Diseno de Cuestionarios, Analisis de Muestras y Calculo de Margenes de Error</p>
    </header>
    
    <div class="container">
        <a href="index.html" class="back-btn">Volver al Inicio</a>
        
        <div class="grid">
            <div class="card">
                <h2>Parametros de la Encuesta</h2>
                <div class="question-box">
                    <label>Tamano de la Poblacion:</label>
                    <input type="number" id="poblacion" value="5000000" min="1000" step="1000">
                </div>
                <div class="question-box">
                    <label>Tamano de la Muestra:</label>
                    <input type="number" id="muestra" value="1200" min="30" step="10">
                </div>
                <div class="question-box">
                    <label>Nivel de Confianza (%):</label>
                    <input type="number" id="confianza" value="95" min="80" max="99.9" step="0.1">
                </div>
                <div class="question-box">
                    <label>Proporcion Estimada (%):</label>
                    <input type="number" id="proporcion" value="50" min="0" max="100" step="1">
                </div>
                <button onclick="calcularMetricas()">Calcular Metricas</button>
            </div>
            
            <div class="card">
                <h2>Resultados de Analisis</h2>
                <div class="stats">
                    <div class="stat">
                        <div>Margen de Error</div>
                        <div class="stat-value" id="margenError">-</div>
                        <small>%</small>
                    </div>
                    <div class="stat">
                        <div>Intervalo Confianza</div>
                        <div class="stat-value" id="intervalo">-</div>
                    </div>
                    <div class="stat">
                        <div>Desv. Estandar</div>
                        <div class="stat-value" id="desvio">-</div>
                    </div>
                </div>
                <div style="background: #0f2a2a; padding: 15px; border-radius: 8px; margin-top: 20px;">
                    <p style="font-size: 0.9em; color: #999; margin-bottom: 10px;">Interpretacion:</p>
                    <p id="interpretacion" style="color: #4db8a8; font-weight: bold;">Ingresa los parametros y calcula...</p>
                </div>
            </div>
        </div>
        
        <div class="card">
            <h2>Tabla de Muestra vs Margen de Error</h2>
            <table>
                <thead>
                    <tr>
                        <th>Tamano Muestra</th>
                        <th>Margen Error (95%)</th>
                        <th>Intervalo Confianza</th>
                        <th>Recomendacion</th>
                    </tr>
                </thead>
                <tbody id="tablaMuestras"></tbody>
            </table>
        </div>
    </div>
    
    <script>
        function calcularMetricas() {
            const poblacion = parseInt(document.getElementById('poblacion').value);
            const muestra = parseInt(document.getElementById('muestra').value);
            const confianza = parseFloat(document.getElementById('confianza').value);
            const proporcion = parseFloat(document.getElementById('proporcion').value) / 100;
            
            // Z-values para diferentes niveles de confianza
            const zValues = { 90: 1.645, 95: 1.96, 99: 2.576, 99.9: 3.291 };
            let zValue = 1.96;
            if (confianza <= 90) zValue = 1.645;
            else if (confianza <= 95) zValue = 1.96;
            else if (confianza <= 99) zValue = 2.576;
            else zValue = 3.291;
            
            // Margen de error
            const p = proporcion;
            const q = 1 - p;
            const margenError = (zValue * Math.sqrt((p * q) / muestra)) * 100;
            
            // Desviacion estandar
            const desvio = Math.sqrt((p * q) / muestra);
            
            // Intervalo de confianza
            const lower = (p - (zValue * desvio)) * 100;
            const upper = (p + (zValue * desvio)) * 100;
            
            document.getElementById('margenError').textContent = margenError.toFixed(2);
            document.getElementById('intervalo').textContent = lower.toFixed(1) + '% - ' + upper.toFixed(1) + '%';
            document.getElementById('desvio').textContent = (desvio * 100).toFixed(3);
            
            let interpretacion = `Con ${muestra} encuestas y ${confianza}% confianza: margin de error \u00b1${margenError.toFixed(2)}%`;
            if (margenError <= 3) interpretacion += ' (EXCELENTE - Muy preciso)';
            else if (margenError <= 5) interpretacion += ' (BUENO - Preciso)';
            else if (margenError <= 10) interpretacion += ' (ACEPTABLE - Moderado)';
            else interpretacion += ' (NECESITA MAS MUESTRA)';
            
            document.getElementById('interpretacion').textContent = interpretacion;
            
            // Generar tabla
            let html = '';
            const muestras = [100, 300, 500, 800, 1000, 1500, 2000];
            muestras.forEach(m => {
                const me = (zValue * Math.sqrt((p * q) / m)) * 100;
                const li = ((p - (zValue * Math.sqrt((p * q) / m))) * 100).toFixed(1);
                const ls = ((p + (zValue * Math.sqrt((p * q) / m))) * 100).toFixed(1);
                const recom = me <= 3 ? 'Excelente' : (me <= 5 ? 'Bueno' : (me <= 10 ? 'Aceptable' : 'Insuficiente'));
                html += `<tr><td>${m}</td><td>\u00b1${me.toFixed(2)}%</td><td>[${li}, ${ls}]</td><td>${recom}</td></tr>`;
            });
            document.getElementById('tablaMuestras').innerHTML = html;
        }
        
        window.onload = () => calcularMetricas();
    </script>
</body>
</html>
